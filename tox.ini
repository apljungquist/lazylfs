[tox]
isolated_build = true

envlist =
    lint
    type
    format
    py37
    htmlcov

[testenv]
passenv = LANG
deps =
    coverage
    pytest
commands =
    coverage run --source=src,tests -p -m pytest --doctest-modules src --durations=10 -m "not slow" tests

[testenv:htmlcov]
depends =
    py37
deps =
    coverage
skip_install = true
commands =
    coverage combine
    coverage html

[testenv:lint]
deps =
    flake8
commands_pre =
commands =
    flake8 setup src tests

[testenv:type]
deps =
    mypy
commands =
    mypy src

[testenv:format]
deps =
    black
skip_install = true
commands =
    black setup.py src tests --check